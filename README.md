# Использование БФП для цифровой обработки изображений

## Предисловие

Цифровая фотография или иное растровое изображение представляет собой массив чисел, зафиксированных сенсорами уровней яркости, в двумерной плоскости.
Зная что с математической точки зрения тонкая линза выполняет преобразование Фурье изображений размещённых в фокальных плоскостях, можно создать алгоритмы обработки изображений, являющихся аналогами обработки изображений классической оптической системой.
### Формула таких алгоритмов будет выглядеть следующим образом:
1. Z=FFT(X) – прямое двухмерное преобразование Фурье
2. Z′=T(Z) – применение функции или транспаранта к Фурье-образу изображения
3. Y=BFT(Z′) – обратное двухмерное преобразование Фурье
Хотя оптическая система линз осуществляет преобразование Фурье на непрерывном диапазоне аргумента и для непрерывного спектра, но при переходе к цифровой обработке данных формулы преобразования Фурье могут быть заменены на формулы дискретного преобразования Фурье.
 
## Алгоритм размытия изображения

В оптических системах диафрагма, размещённая в фокальной плоскости,  представляет собой простое отверстие в экране. В результате прохождения светового  потока через диафрагму, волны высоких частот (с более короткими длинами волн) проходят через препятствие, а волны с низких частот (с более длинными длинами волн) отсекаются экраном. Таким образом повышается резкость получаемого изображения.
Если заменить отверстие в экране на препятствие в экране, то в результате будет получено размытое изображение, поскольку оно будет сформировано из частот волн больших длин.
### Алгоритм:
1. Пусть X(N1,N2) – массив яркостей пикселей изображения.
2. Вычислить Px = средняя (среднеквадратичная) яркость пикселей в массиве X
3. Вычислить массив Z=FT(X) – прямое двухмерное дискретное преобразование Фурье
4. Вычислить массив Z′=T(Z), где T – обнуление строк и столбцов, находящихся в заданных внутренних областях матрицы-аргумента соответствующих высоким 5. частотам (то есть обнуление коэффициентов Фурье-разложения, соответствующих высоким частотам)
6. Вычислить массив Y=RFT(Z′) – обратное двухмерное дискретное преобразование Фурье
7. Вычислить Py = средняя (среднеквадратичная) яркость пикселей в массиве Y
8. Нормировать массив Y(N1,N2) по среднему уровню яркости Px/Py

## Алгоритм повышения резкости изображения

В оптических системах диафрагма, размещённая в фокальной плоскости,  представляет собой простое отверстие в экране. В результате прохождения светового  потока через диафрагму, волны высоких частот (с более короткими длинами волн) проходят через препятствие, а волны с низких частот (с более длинными длинами волн) отсекаются экраном. Таким образом повышается резкость получаемого изображения.
### Алгоритм:
1. Пусть X(N1,N2) – массив яркостей пикселей изображения.
2. Вычислить Px = средняя (среднеквадратичная) яркость пикселей в массиве X
3. Вычислить массив Z=FT(X) – прямое двухмерное дискретное преобразование Фурье
4. Сохранить значение L=Z(0,0) – соответствующее средней яркости пикселей исходного изображения
5. Вычислить массив Z′=T(Z), где T – обнуление строк и столбцов, находящихся в заданных внешних областях матрицы-аргумента, соответствующих низким 6. частотам (то есть обнуление коэффициентов Фурье-разложения, соответствующих низким частотам)
7. Восстановить значение Z’(0,0)=L – соответствующее средней яркости пикселей исходного изображения
8. Вычислить массив Y=RFT(Z′) – обратное двухмерное дискретное преобразование Фурье
9. Вычислить Py = средняя (среднеквадратичная) яркость пикселей в массиве Y
10. Нормировать массив Y(N1,N2) по среднему уровню яркости Px/Py

## Алгоритм масштабирования изображения

В оптических системах световой поток в фокальной плоскости системы представляет собой Фурье-преобразование исходного изображения. Размер получаемого на выходе оптической системы изображения определяется соотношением фокальных расстояний объектива и окуляра.
### Алгоритм:
1. Пусть X(N1,N2) – массив яркостей пикселей изображения.
2. Вычислить Px = средняя (среднеквадратичная) яркость пикселей в массиве X
3. Вычислить массив Z=FT(X) – прямое двухмерное дискретное преобразование Фурье
4. Вычислить массив Z′=T(Z), где T – либо добавление нулевых строк и столбцов матрицы соответствующих высоким частотам, либо удаление строк и столбцов матрицы соответствующих высоким частотам для получения требуемого размера итогового изображения
5. Вычислить массив Y=RFT(Z′) – обратное двухмерное дискретное преобразование Фурье
6. Вычислить Py = средняя (среднеквадратичная) яркость пикселей в массиве Y
7. Нормировать массив Y(M1,M2) по среднему уровню яркости Px/Py

## Используемое программное обеспечение

- Microsoft Visual Studio 2013 C# - среда и язык программирования
- EmguCV/OpenCV – C++ библиотека структур и алгоритмов для обработки изображений
- FFTWSharp/FFTW – C++ библиотека реализующая алгоритмы быстрого дискретного преобразования Фурье

## Литература
- А.Л. Дмитриев. Оптические методы обработки информации. Учебное пособие. СПб. СПюГУИТМО 2005. 46 с.  
- А.А.Акаев, С.А.Майоров «Оптические методы обработки информации» М.:1988  
- Дж.Гудмен «Введение в Фурье-оптику» М.:Мир 1970
